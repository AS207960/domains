{% extends "domains_email/email_base.txt" %}
{% block content %}
We have received a report from SWITCH concerning invalid DMARC or SPF records for the domain {{ domain.domain }}.
The details of the report are below. The report was generated on {{ error_date }}.

{% if dmarc_status %}DMARC{% if dmarc_status.no_measurement_data %}
- No measurement data (NXDOMAIN, SERVFAIL, timeout, etc){% endif %}{% if dmarc_status.no_dmarc_record %}
- No DMARC record configured. This composite signals that TXT data exists on the _dmarc. But it does not start with the v=DMARC1 prefix.{% endif %}{% if dmarc_status.syntax_error %}
- Syntax error{% endif %}{% if dmarc_status.more_than_one_dmarc_record %}
- More than one DMARC record.{% endif %}{% if dmarc_status.dmarc_none_policy %}
- The DMARC record's specified policy is 'none'.{% endif %}{% if dmarc_status.dmarc_pct_below_100 %}
- The DMARC record specifies the optional 'pct' tag with a value that is below 100.{% endif %}{% if dmarc_status.invalid_dmarc_tag %}
- One of the tags in the DMARC record is not valid.{% endif %}{% if dmarc_status.invalid_dmarc_tag_value %}
- A given tag value is not valid.{% endif %}

{% endif %}{% if spf_status %}SPF{% if spf_status.no_measurement_data %}
- No measurement data (NXDOMAIN, SERVFAIL, timeout, etc){% endif %}{% if spf_status.no_spf_record %}
- TXT data exists on the @ label but none of the TXT records starts with v=spf1.{% endif %}{% if spf_status.syntax_error %}
- Syntax error.{% endif %}{% if spf_status.more_than_one_spf_record %}
- More than one SPF record.{% endif %}{% if spf_status.prohibited_all_qualifier %}
- The SPF record (primary or aGer redirect) terminates with an (implied) 'all'  basic mechanism and (implied) '+' or '?' qualifier.{% endif %}{% if spf_status.ipv4_prefix_too_large %}
- The SPF record (or its expansion) has (at least one) ip4 designated sender mechanism that has too broad of a prefix (< /14).{% endif %}{% if spf_status.ipv6_prefix_too_large %}
- The SPF record (or its expansion) has (at least one) ip6 designated sender mechanism that has too broad of a prefix (< /32).{% endif %}{% if spf_status.too_many_dns_lookups %}
- 10 DNS lookups exceeded (see RFC 7208 section 4.6.4).{% endif %}{% if spf_status.too_many_void_lookups %}
- 2 void lookups exceeded (see RFC 7208 section 4.6.4).{% endif %}{% if spf_status.redirect_loop %}
- Redirect mechanism loop.{% endif %}{% if spf_status.include_loop %}
- Include mechanism loop.{% endif %}{% if spf_status.included_record_does_not_exist %}
- Include expansion leads to non-existent SPF record (e.g., include:fqdn and no v=spf1 record at fqdn).{% endif %}
{% endif %}
{% endblock content %}